<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; kerchunk  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Non-zarr uses" href="nonzarr.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> kerchunk<img src="_static/kerchunk.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0+unknown
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="test_example.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="detail.html">Detailed description</a></li>
<li class="toctree-l1"><a class="reference internal" href="cases.html">Case studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="spec.html">References specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="beyond.html">Beyond Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonzarr.html">Non-zarr uses</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">kerchunk</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/reference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#kerchunk.hdf.SingleHdf5ToZarr" title="kerchunk.hdf.SingleHdf5ToZarr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kerchunk.hdf.SingleHdf5ToZarr</span></code></a>(h5f[, url, …])</p></td>
<td><p>Translate the content of one HDF5 file into Zarr metadata.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kerchunk.grib2.scan_grib</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kerchunk.grib2.GRIBCodec</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kerchunk.combine.MultiZarrToZarr" title="kerchunk.combine.MultiZarrToZarr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kerchunk.combine.MultiZarrToZarr</span></code></a>(path[, …])</p></td>
<td><p>Combine multiple kerchunk’d datasets into a single logical aggregate dataset</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kerchunk.fits.process_file" title="kerchunk.fits.process_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kerchunk.fits.process_file</span></code></a>(url[, …])</p></td>
<td><p>Create JSON references for a single FITS file as a zarr group</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kerchunk.tiff.tiff_to_zarr" title="kerchunk.tiff.tiff_to_zarr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kerchunk.tiff.tiff_to_zarr</span></code></a>(urlpath[, …])</p></td>
<td><p>Wraps TIFFFile’s fsspec writer to extract metadata as attributes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kerchunk.netCDF3.netcdf_recording_file</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kerchunk.netCDF3.RecordArrayMember</span></code></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="kerchunk.hdf.SingleHdf5ToZarr">
<em class="property">class </em><code class="sig-prename descclassname">kerchunk.hdf.</code><code class="sig-name descname">SingleHdf5ToZarr</code><span class="sig-paren">(</span><em class="sig-param">h5f: BinaryIO | str</em>, <em class="sig-param">url: str = None</em>, <em class="sig-param">spec=1</em>, <em class="sig-param">inline_threshold=100</em>, <em class="sig-param">storage_options=None</em>, <em class="sig-param">error='warn'</em>, <em class="sig-param">vlen_encode='embed'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kerchunk/hdf.html#SingleHdf5ToZarr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kerchunk.hdf.SingleHdf5ToZarr" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the content of one HDF5 file into Zarr metadata.</p>
<p>HDF5 groups become Zarr groups. HDF5 datasets become Zarr arrays. Zarr array
chunks remain in the HDF5 file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>h5f</strong><span class="classifier">file-like or str</span></dt><dd><p>Input HDF5 file. Can be a binary Python file-like object (duck-typed, adhering
to BinaryIO is optional), in which case must also provide url. If a str,
file will be opened using fsspec and storage_options.</p>
</dd>
<dt><strong>url</strong><span class="classifier">string</span></dt><dd><p>URI of the HDF5 file, if passing a file-like object</p>
</dd>
<dt><strong>spec</strong><span class="classifier">int</span></dt><dd><p>The version of output to produce (see README of this repo)</p>
</dd>
<dt><strong>inline_threshold</strong><span class="classifier">int</span></dt><dd><p>Include chunks smaller than this value directly in the output. Zero or negative
to disable</p>
</dd>
<dt><strong>storage_options: dict</strong></dt><dd><p>passed to fsspec if h5f is a str</p>
</dd>
<dt><strong>error: “warn” (default) | “pdb” | “ignore”</strong></dt><dd></dd>
<dt><strong>vlen_encode: [“embed”, “null”, “leave”, “encode”]</strong></dt><dd><p>What to do with VLEN string variables or columns of tabular variables
leave: pass through the 16byte garbage IDs unaffected, but requires no codec
null: set all the strings to None or empty; required that this library is available</p>
<blockquote>
<div><p>at read time</p>
</div></blockquote>
<p>embed: include all the values in the output JSON (should not be used for large tables)
encode: save the ID-to-value mapping in a codec, to produce the real values at read</p>
<blockquote>
<div><p>time; requires this library to be available. Can be efficient storage where there
are few unique values.</p>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#kerchunk.hdf.SingleHdf5ToZarr.translate" title="kerchunk.hdf.SingleHdf5ToZarr.translate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">translate</span></code></a>()</p></td>
<td><p>Translate content of one HDF5 file into Zarr storage format.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="kerchunk.hdf.SingleHdf5ToZarr.translate">
<code class="sig-name descname">translate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kerchunk/hdf.html#SingleHdf5ToZarr.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kerchunk.hdf.SingleHdf5ToZarr.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate content of one HDF5 file into Zarr storage format.</p>
<p>This method is the main entry point to execute the workflow, and
returns a “reference” structure to be used with zarr/kerchunk</p>
<p>No data is copied out of the HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>dict</dt><dd><p>Dictionary containing reference structure.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="kerchunk.combine.MultiZarrToZarr">
<em class="property">class </em><code class="sig-prename descclassname">kerchunk.combine.</code><code class="sig-name descname">MultiZarrToZarr</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">coo_map=None</em>, <em class="sig-param">concat_dims=None</em>, <em class="sig-param">coo_dtypes=None</em>, <em class="sig-param">identical_dims=None</em>, <em class="sig-param">target_options=None</em>, <em class="sig-param">remote_protocol=None</em>, <em class="sig-param">remote_options=None</em>, <em class="sig-param">inline_threshold=500</em>, <em class="sig-param">preprocess=None</em>, <em class="sig-param">postprocess=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kerchunk/combine.html#MultiZarrToZarr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kerchunk.combine.MultiZarrToZarr" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine multiple kerchunk’d datasets into a single logical aggregate dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – str, list(str) or list(dict)
Local paths, each containing a references JSON; or a list of references dicts</p></li>
<li><p><strong>concat_dims</strong> – str or list(str)
Names of the dimensions to expand with</p></li>
<li><p><strong>coo_map</strong> – <p>dict(str, selector)
The special key “var” means the variable name in the output, which will be
“VARNAME” by default (i.e., variable names are the same as in the input
datasets). The default for any other coordinate is <a class="reference external" href="data:varname">data:varname</a>, i.e., look
for an array with that name.</p>
<dl class="simple">
<dt>Selectors (“how to get coordinate values from a dataset”) can be:</dt><dd><ul>
<li><p>a constant value (usually str for a var name, number for a coordinate)</p></li>
<li><p>a compiled regex <code class="docutils literal notranslate"><span class="pre">re.Pattern</span></code>, which will be applied to the filename.
Should return exactly one value</p></li>
<li><p>a string beginning “attr:” which will fetch this attribute from the zarr
dataset of each path</p></li>
<li><p>a string beginning “vattr:{var}:” as above, but the attribute is taken from
the array named var</p></li>
<li><p>”VARNAME” special value where a dataset contains multiple variables, just use
the variable names as given</p></li>
<li><p>”INDEX” special value for the index of how far through the list of inputs
we are so far</p></li>
<li><p>a string beginning “data:{var}” which will get the appropriate zarr array
from each input dataset.</p></li>
<li><p>”cf:{var}”, interpret the value of var using cftime, returning a datetime.
These will be automatically re-encoded with cftime, <em>unless</em> you specify an
“M8[*]” dtype for the coordinate, in which case a conversion will be attempted.</p></li>
<li><p>a list with the values that are known beforehand</p></li>
<li><p>a function with signature (index, fs, var, fn) -&gt; value, where index is an int
counter, fs is the file system made for the current input, var is the variable
we are probing may be “var”) and fn is the filename or None if dicts were used
as input</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>coo_dtypes</strong> – map(str, str|np.dtype)
Coerce the final type of coordinate arrays (otherwise use numpy default)</p></li>
<li><p><strong>identical_dims</strong> – list[str]
Variables that are to be copied across from the first input dataset, because they do not vary.</p></li>
<li><p><strong>target_options</strong> – dict
Storage options for opening <code class="docutils literal notranslate"><span class="pre">path</span></code></p></li>
<li><p><strong>remote_protocol</strong> – str
The protocol of the original data</p></li>
<li><p><strong>remote_options</strong> – dict</p></li>
<li><p><strong>inline_threshold</strong> – int
Size below which binary blocks are included directly in the output</p></li>
<li><p><strong>preprocess</strong> – callable
Acts on the references dict of all inputs before processing. See <code class="docutils literal notranslate"><span class="pre">drop()</span></code>
for an example.</p></li>
<li><p><strong>postprocess</strong> – callable
Acts on the references dict before output.
postprocess(dict)-&gt; dict</p></li>
<li><p><strong>validate_dataet</strong> – callable</p></li>
<li><p><strong>validate_variable</strong> – callable</p></li>
<li><p><strong>validate_chunk</strong> – callable</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference internal" href="#kerchunk.combine.MultiZarrToZarr.fss" title="kerchunk.combine.MultiZarrToZarr.fss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fss</span></code></a></dt><dd><p>filesystem instances being analysed, one per input dataset</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#kerchunk.combine.MultiZarrToZarr.first_pass" title="kerchunk.combine.MultiZarrToZarr.first_pass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">first_pass</span></code></a>()</p></td>
<td><p>Accumulate the set of concat coords values across all inputs</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kerchunk.combine.MultiZarrToZarr.second_pass" title="kerchunk.combine.MultiZarrToZarr.second_pass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">second_pass</span></code></a>()</p></td>
<td><p>map every input chunk to the output</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kerchunk.combine.MultiZarrToZarr.store_coords" title="kerchunk.combine.MultiZarrToZarr.store_coords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">store_coords</span></code></a>()</p></td>
<td><p>Write coordinate arrays into the output</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kerchunk.combine.MultiZarrToZarr.translate" title="kerchunk.combine.MultiZarrToZarr.translate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">translate</span></code></a>([filename, storage_options])</p></td>
<td><p>Perform all stages and return the resultant references dict</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="kerchunk.combine.MultiZarrToZarr.first_pass">
<code class="sig-name descname">first_pass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kerchunk/combine.html#MultiZarrToZarr.first_pass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kerchunk.combine.MultiZarrToZarr.first_pass" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulate the set of concat coords values across all inputs</p>
</dd></dl>

<dl class="method">
<dt id="kerchunk.combine.MultiZarrToZarr.fss">
<em class="property">property </em><code class="sig-name descname">fss</code><a class="headerlink" href="#kerchunk.combine.MultiZarrToZarr.fss" title="Permalink to this definition">¶</a></dt>
<dd><p>filesystem instances being analysed, one per input dataset</p>
</dd></dl>

<dl class="method">
<dt id="kerchunk.combine.MultiZarrToZarr.second_pass">
<code class="sig-name descname">second_pass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kerchunk/combine.html#MultiZarrToZarr.second_pass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kerchunk.combine.MultiZarrToZarr.second_pass" title="Permalink to this definition">¶</a></dt>
<dd><p>map every input chunk to the output</p>
</dd></dl>

<dl class="method">
<dt id="kerchunk.combine.MultiZarrToZarr.store_coords">
<code class="sig-name descname">store_coords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kerchunk/combine.html#MultiZarrToZarr.store_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kerchunk.combine.MultiZarrToZarr.store_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Write coordinate arrays into the output</p>
</dd></dl>

<dl class="method">
<dt id="kerchunk.combine.MultiZarrToZarr.translate">
<code class="sig-name descname">translate</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">storage_options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kerchunk/combine.html#MultiZarrToZarr.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kerchunk.combine.MultiZarrToZarr.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform all stages and return the resultant references dict</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="kerchunk.fits.process_file">
<code class="sig-prename descclassname">kerchunk.fits.</code><code class="sig-name descname">process_file</code><span class="sig-paren">(</span><em class="sig-param">url</em>, <em class="sig-param">storage_options=None</em>, <em class="sig-param">extension=None</em>, <em class="sig-param">inline_threshold=100</em>, <em class="sig-param">primary_attr_to_group=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kerchunk/fits.html#process_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kerchunk.fits.process_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create JSON references for a single FITS file as a zarr group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>url: str</strong></dt><dd><p>Where the file is</p>
</dd>
<dt><strong>storage_options: dict</strong></dt><dd><p>How to load that file (passed to fsspec)</p>
</dd>
<dt><strong>extension: list(int | str) | int | str or None</strong></dt><dd><p>Which extensions to include. Can be ordinal integer(s), the extension name (str) or if None,
uses the first data extension</p>
</dd>
<dt><strong>inline_threshold: int</strong></dt><dd><p>(not yet implemented)</p>
</dd>
<dt><strong>primary_attr_to_group: bool</strong></dt><dd><p>Whether the output top-level group contains the attributes of the primary extension
(which often contains no data, just a general description)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>dict of the references</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="kerchunk.tiff.tiff_to_zarr">
<code class="sig-prename descclassname">kerchunk.tiff.</code><code class="sig-name descname">tiff_to_zarr</code><span class="sig-paren">(</span><em class="sig-param">urlpath</em>, <em class="sig-param">remote_options=None</em>, <em class="sig-param">target=None</em>, <em class="sig-param">target_options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kerchunk/tiff.html#tiff_to_zarr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#kerchunk.tiff.tiff_to_zarr" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps TIFFFile’s fsspec writer to extract metadata as attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>urlpath: str</strong></dt><dd><p>Location of input TIFF</p>
</dd>
<dt><strong>remote_options: dict</strong></dt><dd><p>pass these to fsspec when opening urlpath</p>
</dd>
<dt><strong>target: str</strong></dt><dd><p>Write JSON to this location. If not given, no file is output</p>
</dd>
<dt><strong>target_options: dict</strong></dt><dd><p>pass these to fsspec when opening target</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>references dict</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nonzarr.html" class="btn btn-neutral float-left" title="Non-zarr uses" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Martin Durant.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>